from textwrap import dedent
import ipaddress


class Formatter(object):
    """
    Abstract class to define the interface for formatters.
    """
    def __init__(self):
        """
        Initialize formatter, maybe generate a preamble for the config
        """
        self.config = []
        self.add_comment(dedent(
            """
            This file is automatically generated.
            """
        ))

    def add_comment(self, comment):
        """
        Add a comment to the config. Default is prefixed with #
        """
        self.config.append("# " + "\n# ".join(comment.split("\n")))

    def add_data(self, asn, name, template, peer):
        """
        Add config directives so that every domain in domains is forwarded to
        every server in servers.
        """
        raise NotImplementedError()

    def add_section(self, name):
        """
        Add new Section Header to SmokePing
        """
        raise NotImplementedError()

    def finalize(self):
        """
        Finalize configuration and return it
        """
        return "\n".join(self.config)

    def is_link_local(self, str):
        """
        Checks, if a given string is a valid IPv6 link local Address
        """
        is_link_local = False
        try:
            addr = ipaddress.IPv6Address(str)
            is_link_local = addr.is_link_local
        finally:
            return is_link_local
